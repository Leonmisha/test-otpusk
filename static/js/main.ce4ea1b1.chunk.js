(this["webpackJsonptest-otpusk"]=this["webpackJsonptest-otpusk"]||[]).push([[0],{15:function(e,t,n){e.exports={Main:"Main_Main__aEwJn",cardsContainer:"Main_cardsContainer__3P5ZV",cards:"Main_cards__1BYCn",search:"Main_search__YvnYq"}},19:function(e,t,n){e.exports={Auth:"Auth_Auth__3-Wh1",form:"Auth_form__2rGng",loginButton:"Auth_loginButton__DrYCx"}},20:function(e,t,n){e.exports={Header:"Header_Header__2dWng",logout:"Header_logout__2AWhG"}},21:function(e,t,n){e.exports={card:"Card_card__1tnPy"}},36:function(e,t,n){},38:function(e,t,n){},47:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(16),o=n.n(r),s=(n(36),n(25)),i=n.n(s),u=n(30),l=n(7),j=(n(38),n(39),n(6)),d=n(10),h=n(19),b=n.n(h),m=n(48),O=n(49),f="qwerty",p=function(e,t){return btoa(JSON.stringify({email:e,password:t}).concat("::".concat(f)))},x=function(e){var t=atob(e).split("::"),n=Object(l.a)(t,2),a=n[0],c=n[1];return{user:JSON.parse(a),secret:c}},v=function(e,t){return Math.random()>.5?Promise.resolve(new Response(JSON.stringify({email:e,token:p(e,t)})),{status:200}):Promise.reject(new Response(JSON.stringify({error:!0,message:"Email or password is incorrect"}),{status:401}))},_=function(e){return Promise.resolve(e).then(x).then((function(e){return e.secret.includes(f)}))},g=function(e){return Promise.resolve(e).then(x).then((function(e){var t=e.user;return delete t.password,t}))},N=function(e){return _(e).then((function(e){return e?new Response(JSON.stringify({data:{10:{company:{alternativeNames:["Fdhjhf","\u0430\u0440\u043e\u0440\u0432\u0430","\u0410\u0420\u041e\u0420\u0412\u0410"],name:"\u0410\u0432\u0440\u043e\u0440\u0430"},date:"25-05-2021"},20:{company:{alternativeNames:[],name:"\u0410\u044d\u0440\u043e\u0444\u043b\u043e\u0442"},date:"29-05-2021"}}}),{status:200}):new Response(JSON.stringify({error:!0,message:"Forbidden"}),{status:403})}))},k="SAVE_LOGIN_INFO",y="USER_LOGOUT",S=function(e){var t=e.email,n=e.token;return{type:k,email:t,token:n}};function w(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return new Promise((function(t,a){e.apply(void 0,n).then((function(e){return e.json()})).then((function(e){return t(e)})).catch((function(e){e.json().then((function(e){return a(e)})).catch((function(e){return a(e)}))}))}))}var C=n(2),E=function(e){var t=Object(d.b)(),n=Object(a.useState)(""),c=Object(l.a)(n,2),r=c[0],o=c[1],s=Object(a.useState)(""),i=Object(l.a)(s,2),u=i[0],j=i[1],h=Object(a.useState)(!1),f=Object(l.a)(h,2),p=f[0],x=f[1],_=Object(a.useState)(!1),g=Object(l.a)(_,2),N=g[0],k=g[1],y=Object(a.useState)(!1),E=Object(l.a)(y,2),I=E[0],A=E[1],M=Object(a.useState)(null),J=Object(l.a)(M,2),z=J[0],D=J[1];function G(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!0,n=/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/;return t=!(!e&&!r||!n.test(r)),k(!t),t}function L(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!0;return t=!(!e&&!u||u.length<3),A(!t),t}return Object(C.jsx)("div",{className:b.a.Auth,children:Object(C.jsxs)(m.a,{className:b.a.form,children:[Object(C.jsxs)(m.a.Group,{controlId:"email",children:[Object(C.jsx)(m.a.Label,{children:"Email"}),Object(C.jsx)(m.a.Control,{type:"email",placeholder:"\u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 tourist@gmail.com",value:r,onChange:function(e){N&&G(!1),o(e.target.value)}}),N&&Object(C.jsx)(m.a.Text,{className:"text-muted",children:"\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u0430\u044f \u043f\u043e\u0447\u0442\u0430"})]}),Object(C.jsxs)(m.a.Group,{controlId:"password",children:[Object(C.jsx)(m.a.Label,{children:"\u041f\u0430\u0440\u043e\u043b\u044c"}),Object(C.jsx)(m.a.Control,{type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",value:u,onChange:function(e){I&&L(!1),j(e.target.value)}}),I&&Object(C.jsx)(m.a.Text,{className:"text-muted",children:"\u041f\u0430\u0440\u043e\u043b\u044c \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0441\u0442\u043e\u044f\u0442\u044c \u0438\u0437 3 \u0438 \u0431\u043e\u043b\u0435\u0435 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"})]}),Object(C.jsx)(m.a.Group,{controlId:"rememberMe",children:Object(C.jsx)(m.a.Check,{type:"checkbox",label:"\u0417\u0430\u043f\u043e\u043c\u043d\u0438\u0442\u044c \u043c\u0435\u043d\u044f",value:p,onChange:function(e){x(e.target.checked)}})}),Object(C.jsx)(O.a,{variant:"primary",type:"submit",className:b.a.loginButton,onClick:function(e){if(e.preventDefault(),!(G(!1)&L(!1)))return!1;w(v,r,u).then((function(e){if(p)try{localStorage.setItem("token",e.token)}catch(n){alert("\u041d\u0435 \u0432\u044b\u0448\u043b\u043e \u0437\u0430\u043f\u043e\u043c\u043d\u0438\u0442\u044c \u0432\u0430\u0441! \u0410 \u0436\u0430\u043b\u044c:(")}t(S({email:e.email,token:e.token}))})).catch((function(e){D(e.message)}))},children:"\u0412\u043e\u0439\u0442\u0438"}),z&&Object(C.jsx)(m.a.Text,{className:"text-muted",children:z})]})})},I=n(14),A=n(15),M=n.n(A),J=n(20),z=n.n(J),D=function(e){var t=e.email,n=Object(d.b)();return Object(C.jsxs)("header",{className:z.a.Header,children:[Object(C.jsx)("div",{className:z.a.email,children:t}),Object(C.jsx)(O.a,{className:z.a.logout,onClick:function(){n({type:y})},variant:"light",children:"\u0412\u044b\u0445\u043e\u0434"})]})},G=n(21),L=n.n(G),P=function(e){var t=e.companyName,n=e.date;return Object(C.jsxs)("div",{className:L.a.card,children:[Object(C.jsx)("div",{className:L.a.companyName,children:t}),Object(C.jsx)("div",{className:L.a.date,children:n})]})},R=function(){var e=Object(d.c)((function(e){return e.token})),t=Object(d.c)((function(e){return e.email})),n=Object(a.useState)([]),c=Object(l.a)(n,2),r=c[0],o=c[1],s=Object(a.useState)(!1),i=Object(l.a)(s,2),u=i[0],j=i[1],h=Object(a.useState)(""),b=Object(l.a)(h,2),O=b[0],f=b[1],p=r.filter((function(e){if(!O)return e;var t=-1!==e.company.name.indexOf(O),n=e.company.alternativeNames.some((function(e){return-1!==e.indexOf(O)}));return t||n}));return Object(a.useEffect)((function(){w(N,e).then((function(e){var t=[];for(var n in e.data)t.push(Object(I.a)({id:n},e.data[n]));t=t.sort((function(e,t){return new Date(e.date)-new Date(t.date)})),o(t),j(!0)})).catch((function(e){}))}),[e]),Object(C.jsxs)("div",{className:M.a.Main,children:[Object(C.jsx)(D,{email:t}),Object(C.jsxs)(m.a.Group,{controlId:"search",className:M.a.search,children:[Object(C.jsx)(m.a.Label,{children:"\u041f\u043e\u0438\u0441\u043a"}),Object(C.jsx)(m.a.Control,{type:"search",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043a\u043e\u043c\u043f\u0430\u043d\u0438\u0438",value:O,onChange:function(e){f(e.target.value)}})]}),u&&Object(C.jsx)("div",{className:M.a.cardsContainer,children:Object(C.jsx)("div",{className:M.a.cards,children:p.map((function(e){return Object(C.jsx)(P,{companyName:e.company.name,date:e.date},e.id)}))})})]})},T=function(){var e=Object(d.b)(),t=Object(d.c)((function(e){return Boolean(e.email&&e.token)})),n=Object(j.g)(),c=Object(a.useState)(!1),r=Object(l.a)(c,2),o=r[0],s=r[1];function h(){if("/login"===n.location.pathname)return n.location;var e="/login";return n.location.pathname&&"/"!==n.location.pathname?{pathname:e,search:"?redirect=".concat(n.location.pathname)}:e}function b(e){if("/login"!==n.location.pathname)return n.location;var t="/profile",a=new URLSearchParams(n.location.search).get("redirect");return null!=a&&"/login"!==a&&(t=a),t}return Object(a.useEffect)((function(){(function(){var t=Object(u.a)(i.a.mark((function t(){var a,c,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a="";try{a=localStorage.getItem("token")}catch(o){a=""}if(!a){t.next=25;break}return t.prev=3,t.next=6,_(a);case 6:c=t.sent,t.next=12;break;case 9:t.prev=9,t.t0=t.catch(3),c=!1;case 12:if(!c){t.next=20;break}return t.next=15,g(a);case 15:r=t.sent,e(S({email:r.email,token:a})),n.push(b(2)),t.next=23;break;case 20:try{localStorage.removeItem("token")}catch(i){}alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438"),n.push(h());case 23:t.next=26;break;case 25:n.push(h());case 26:s(!0);case 27:case"end":return t.stop()}}),t,null,[[3,9]])})));return function(){return t.apply(this,arguments)}})()()}),[e,n]),Object(C.jsx)("div",{className:"App",children:o&&(t?Object(C.jsxs)(j.d,{children:[Object(C.jsx)(j.b,{path:"/profile",children:Object(C.jsx)(R,{})}),Object(C.jsx)(j.a,{from:"/login",to:b()})]}):Object(C.jsxs)(j.d,{children:[Object(C.jsx)(j.b,{path:"/login",children:Object(C.jsx)(E,{})}),Object(C.jsx)(j.a,{to:h()})]}))})},B=n(31),H={email:"",token:""};var U=Object(B.a)((function(e,t){return t.type===y&&(localStorage.removeItem("token"),e=void 0),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case k:return Object(I.a)(Object(I.a)({},e),{},{email:t.email,token:t.token});default:return e}}(e,t)}),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()),V=n(18);o.a.render(Object(C.jsx)(c.a.StrictMode,{children:Object(C.jsx)(V.a,{basename:"/test-otpusk",children:Object(C.jsx)(d.a,{store:U,children:Object(C.jsx)(T,{})})})}),document.getElementById("root"))}},[[47,1,2]]]);
//# sourceMappingURL=main.ce4ea1b1.chunk.js.map